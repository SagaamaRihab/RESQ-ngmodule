<div class="map-container" *ngIf="nodes.length > 0">

  <h3>Mappa schematica del percorso di evacuazione</h3>

  <!-- MAPPA -->
  <svg [attr.width]="nodes.length * 160"
       height="200"
       class="map-svg">

    <!-- CORRIDOI -->
    <ng-container *ngFor="let node of nodes; let i = index">
      <line
        *ngIf="i < nodes.length - 1"
         [attr.x1]="node.x"
         [attr.y1]="node.y"
         [attr.x2]="nodes[i + 1].x"
         [attr.y2]="nodes[i + 1].y"
         class="corridor animated"
         [style.animationDelay]="(i * 0.4) + 's'" />
    </ng-container>

    <!-- NODI -->
    <ng-container *ngFor="let node of nodes; let i = index">
      <circle
        [attr.cx]="node.x"
        [attr.cy]="node.y"
        r="26"
        class="node animated-node"
        [class.start]="isStart(i)"
        [class.exit]="isExit(i)"
        (click)="selectNode(node.id)"
        [style.animationDelay]="(i * 0.4 + 0.2) + 's'" />


      <text
        [attr.x]="node.x"
        [attr.y]="node.y + 5"
        text-anchor="middle"
        class="label">
        {{ node.id }}
      </text>
    </ng-container>

  </svg>

   <!-- DESCRIZIONE -->
  <div class="description">
    {{ description }}
  </div>

  <!-- LEGENDA -->
  <div class="legend">
    <div class="legend-item">
      <span class="legend-node start"></span> Nodo di partenza / intermedio
    </div>
    <div class="legend-item">
      <span class="legend-node exit"></span> Uscita di emergenza
    </div>
    <div class="legend-item">
      <span class="legend-line"></span> Corridoio percorribile
    </div>
  </div>
  <div *ngIf="selectedNode" class="node-info">
  <h4>Informazioni nodo</h4>
  <p><strong>ID:</strong> {{ selectedNode }}</p>
  <p><strong>Tipo:</strong> {{ getNodeDescription(selectedNode) }}</p>
</div>


</div>
